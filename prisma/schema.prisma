// Schema para Sistema de Gerenciamento de Pedidos - Marmitaria
// Sistema profissional para gerenciamento de cardápio e pedidos

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Categoria {
  id          String   @id @default(cuid())
  nome        String   @unique
  descricao   String?
  ordem       Int      @default(0)
  ativa       Boolean  @default(true)
  visivel     Boolean  @default(true) // Toggle para categoria "Do dia"
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // Relacionamento com itens do cardápio
  itens       ItemCardapio[]
  
  @@map("categorias")
}

model ItemCardapio {
  id            String   @id @default(cuid())
  nome          String
  descricao     String?
  preco         Float
  imagem        String?
  ativo         Boolean  @default(true)
  disponivel    Boolean  @default(true)
  destaque      Boolean  @default(false)
  sugestaoChef  Boolean  @default(false)
  categoriaId   String
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  
  // Relacionamentos
  categoria     Categoria @relation(fields: [categoriaId], references: [id])
  itensPedido   ItemPedido[]
  
  @@map("itens_cardapio")
}

model Pedido {
  id          String   @id @default(cuid())
  nomeCliente String
  observacao  String?
  total       Float
  status      String   @default("novo") // novo, em_preparo, pronto, entregue
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // Relacionamento com itens do pedido
  itens       ItemPedido[]
  
  @@map("pedidos")
}

model ItemPedido {
  id              String @id @default(cuid())
  pedidoId        String
  itemCardapioId  String
  quantidade      Int    @default(1)
  preco           Float  // Preço no momento do pedido
  observacao      String? // Observações específicas do item
  
  // Relacionamentos
  pedido          Pedido @relation(fields: [pedidoId], references: [id], onDelete: Cascade)
  itemCardapio    ItemCardapio @relation(fields: [itemCardapioId], references: [id])
  
  @@map("itens_pedido")
}
